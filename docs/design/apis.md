# API è¨­è¨ˆæ›¸

## ğŸ“‹ ç¾çŠ¶ã® API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### 1. ãƒˆãƒ¼ã‚¯é–¢é€£ (`/api/talks`)

#### POST `/api/talks`

**èª¬æ˜**: æ–°ã—ã„ãƒˆãƒ¼ã‚¯ã‚’ç™»éŒ²ã™ã‚‹
**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:

```json
{
  "presenter": "string",
  "email": "string",
  "title": "string",
  "duration": "number",
  "topic": "string",
  "description": "string",
  "image_url": "string",
  "presentation_date": "string (YYYY-MM-DD)",
  "venue": "string", // ğŸ”¥ å‰Šé™¤äºˆå®š
  "neonuuid": "number",
  "fullname": "string",
  "has_presentation": "boolean",
  "presentation_url": "string",
  "allow_archive": "boolean",
  "archive_url": "string",
  "presentation_start_time": "string (HH:MM)"
}
```

#### GET `/api/talks`

**èª¬æ˜**: ç™»éŒ²ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ä¸€è¦§ã‚’å–å¾—ã™ã‚‹

#### PUT `/api/talks`

**èª¬æ˜**: ãƒˆãƒ¼ã‚¯ã‚’æ›´æ–°ã™ã‚‹
**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: POST ã¨åŒã˜ + `id`

#### DELETE `/api/talks`

**èª¬æ˜**: ãƒˆãƒ¼ã‚¯ã‚’å‰Šé™¤ã™ã‚‹

### 2. å€‹åˆ¥ãƒˆãƒ¼ã‚¯ (`/api/talk/[id]`)

#### GET `/api/talk/[id]`

**èª¬æ˜**: æŒ‡å®šã•ã‚ŒãŸ ID ã®ãƒˆãƒ¼ã‚¯ã‚’å–å¾—ã™ã‚‹

#### PATCH `/api/talk/[id]`

**èª¬æ˜**: ãƒˆãƒ¼ã‚¯ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°ã™ã‚‹ï¼ˆç®¡ç†è€…ç”¨ï¼‰

### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£

#### GET `/api/user-talks/[user_id]`

**èª¬æ˜**: æŒ‡å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒˆãƒ¼ã‚¯ä¸€è¦§ã‚’å–å¾—ã™ã‚‹

#### GET `/api/user-id`

**èª¬æ˜**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ ID ã‚’å–å¾—ã™ã‚‹

#### POST `/api/sync-user`

**èª¬æ˜**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’åŒæœŸã™ã‚‹

#### POST `/api/update-fullname`

**èª¬æ˜**: ãƒ•ãƒ«ãƒãƒ¼ãƒ ã‚’æ›´æ–°ã™ã‚‹

#### GET `/api/get-fullname`

**èª¬æ˜**: ãƒ•ãƒ«ãƒãƒ¼ãƒ ã‚’å–å¾—ã™ã‚‹

#### DELETE `/api/user-delete`

**èª¬æ˜**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹

### 4. ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢é€£

#### GET `/api/schedule-dates`

**èª¬æ˜**: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå­˜åœ¨ã™ã‚‹æ—¥ä»˜ã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹
**ç¾åœ¨ã®å®Ÿè£…**: æ‰¿èªæ¸ˆã¿ãƒˆãƒ¼ã‚¯ã® presentation_date ã‹ã‚‰é‡è¤‡ãªã—ã§å–å¾—

#### GET `/api/daily-schedule?date=YYYY-MM-DD`

**èª¬æ˜**: æŒ‡å®šã•ã‚ŒãŸæ—¥ä»˜ã®ãƒˆãƒ¼ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å–å¾—ã™ã‚‹
**ç¾åœ¨ã®å®Ÿè£…**: æ‰¿èªæ¸ˆã¿ãƒˆãƒ¼ã‚¯ã‚’ presentation_start_time ã§æ˜‡é †ã‚½ãƒ¼ãƒˆ

#### POST `/api/daily-schedule`

**èª¬æ˜**: è¤‡æ•°ã®ãƒˆãƒ¼ã‚¯ã®é–‹å§‹æ™‚åˆ»ã‚’ä¸€æ‹¬æ›´æ–°ï¼ˆç®¡ç†è€…ç”¨ï¼‰

### 5. ãã®ä»–

#### GET `/api/debug-schema`

**èª¬æ˜**: ãƒ‡ãƒãƒƒã‚°ç”¨ã‚¹ã‚­ãƒ¼ãƒæƒ…å ±å–å¾—

#### POST `/api/test-discord`

**èª¬æ˜**: Discord é€šçŸ¥ãƒ†ã‚¹ãƒˆ

---

## ğŸ”¥ å¤‰æ›´ãŒå¿…è¦ãª API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ğŸ“ **ä¿®æ­£ãŒå¿…è¦ãªæ—¢å­˜ API**

#### 1. `POST/PUT /api/talks`

- âŒ **å‰Šé™¤**: `venue` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- â• **è¿½åŠ **: `session_id` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
- â• **è¿½åŠ **: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆsession_id ãŒå­˜åœ¨ã—ã€ã‹ã¤é¸æŠã•ã‚ŒãŸæ™‚é–“ãŒã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“å†…ï¼‰

#### 2. `GET /api/schedule-dates`

- âŒ **å¤‰æ›´**: `talks.presentationDate`ã‹ã‚‰å–å¾— â†’ `lt_sessions.date`ã‹ã‚‰å–å¾—
- ğŸ”„ **ãƒ­ã‚¸ãƒƒã‚¯å¤‰æ›´**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰æœ‰åŠ¹ãªæ—¥ä»˜ã‚’è¿”ã™

#### 3. `GET /api/daily-schedule`

- â• **JOIN è¿½åŠ **: `lt_sessions`ãƒ†ãƒ¼ãƒ–ãƒ«ã¨çµåˆã—ã¦ venue æƒ…å ±ã‚’å–å¾—
- â• **è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**: session æƒ…å ±ï¼ˆç¬¬ â—‹ å›ã€venue ç­‰ï¼‰

### ğŸ“ **æ–°è¦ä½œæˆãŒå¿…è¦ãª API**

#### 4. `GET/POST/PUT/DELETE /api/lt-sessions`

**æ–°è¦**: LT ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† API

```json
// GET Response
{
  "sessions": [
    {
      "id": "number",
      "session_number": "number",
      "date": "string (YYYY-MM-DD)",
      "title": "string",
      "venue": "string",
      "start_time": "string (HH:MM)",
      "end_time": "string (HH:MM)"
    }
  ]
}

// POST Request
{
  "session_number": "number",
  "date": "string (YYYY-MM-DD)",
  "title": "string",
  "venue": "string",
  "start_time": "16:30", // å›ºå®šå€¤
  "end_time": "18:00"   // å›ºå®šå€¤
}
```

#### 5. `GET /api/available-sessions`

**æ–°è¦**: ãƒ•ã‚©ãƒ¼ãƒ ã§åˆ©ç”¨å¯èƒ½ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã‚’å–å¾—

```json
{
  "sessions": [
    {
      "id": "number",
      "session_number": "number",
      "date": "string",
      "title": "string",
      "venue": "string"
    }
  ]
}
```

---

## âš ï¸ **å½±éŸ¿ã‚’å—ã‘ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´å‡¦ç†**

### ãƒ•ã‚©ãƒ¼ãƒ é–¢é€£

- `TalkForm.tsx`: venue é¸æŠ â†’ session é¸æŠã«å¤‰æ›´
- `EditableTalkCard.tsx`: venue å‰Šé™¤
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³: æ™‚é–“åˆ¶é™ãƒã‚§ãƒƒã‚¯ï¼ˆ16:30-18:00ï¼‰

### è¡¨ç¤ºé–¢é€£

- `SchedulePage.tsx`: venue æƒ…å ±ã‚’ session ã‹ã‚‰å–å¾—
- `AdminPage.tsx`: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã‚¿ãƒ–è¿½åŠ 

---

## ğŸ“ˆ **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”»**

### ãƒ•ã‚§ãƒ¼ã‚º 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¤‰æ›´

1. `lt_sessions`ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ 
2. `talks`ãƒ†ãƒ¼ãƒ–ãƒ«ã«`session_id`è¿½åŠ 
3. æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ç§»è¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ

### ãƒ•ã‚§ãƒ¼ã‚º 2: API å¤‰æ›´

1. æ–°è¦ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
2. æ—¢å­˜ API ä¿®æ­£ï¼ˆå¾Œæ–¹äº’æ›æ€§ç¶­æŒï¼‰

### ãƒ•ã‚§ãƒ¼ã‚º 3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¯¾å¿œ

1. ãƒ•ã‚©ãƒ¼ãƒ ä¿®æ­£
2. è¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¿®æ­£
3. ç®¡ç†ç”»é¢æ‹¡å¼µ

---

## ğŸš¨ **æ³¨æ„äº‹é …**

- **æ™‚é–“åˆ¶é™**: ç™ºè¡¨æ™‚é–“ã¯ 16:30-18:00 ã®ç¯„å›²å†…ã®ã¿
- **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: session å‰Šé™¤æ™‚ã¯ talk.session_id ã‚’ null ã«è¨­å®š
- **å¾Œæ–¹äº’æ›æ€§**: æ—¢å­˜ã® venue ãƒ‡ãƒ¼ã‚¿ã¯ä¸€æ™‚çš„ã«ä¿æŒã—ã¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
